@model List<ReferralGroupViewModel>
@{
    ViewData["Title"] = "Liên Kết";
}

@section Scripts{
    <script src="~/admin-app/controllers/referral/index.js" asp-append-version="true"></script>
    <script>
        var referralObj = new ReferralController();
        referralObj.initialize();
    </script>
}

@section Styles{
    @*<link href="~/admin-app/controllers/referral/index.css" rel="stylesheet" asp-append-version="true" />*@
}

<div class="app-content icon-content">
    <div class="section">
        <!-- Page-header opened -->
        <div class="page-header">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#"><i class="ti-package mr-1"></i> Trang Chủ</a></li>
                <li class="breadcrumb-item active" aria-current="page">@ViewData["Title"]</li>
            </ol>
            <div class="mt-3 mt-lg-0">
                <div class="d-flex align-items-center flex-wrap text-nowrap">
                    <button type="button" class="btn btn-success btn-icon-text mr-2 mb-2 mb-md-0"><i class="fe fe-download"></i>Import</button>
                    <button type="button" class="btn btn-secondary btn-icon-text mr-2 mb-2 mb-md-0"><i class="fe fe-printer"></i>Print</button>
                    <button type="button" class="btn btn-primary btn-icon-text mb-2 mb-md-0"><i class="fe fe-download-cloud "></i>Download</button>
                </div>
            </div>
        </div>
        <!-- Page-header closed -->
        <!-- row opened -->
        <div class="row">
            <div class="col-xl-12">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Liên Kết Tuyến Trên</h3>
                        <div class="card-options ">
                            <a href="#" class="card-options-collapse" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>
                            <a href="#" class="card-options-fullscreen" data-toggle="card-fullscreen"><i class="fe fe-maximize"></i></a>
                            <a href="#" class="card-options-remove" data-toggle="card-remove"><i class="fe fe-x"></i></a>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- row -->
                        <div class="row">
                            <div class="col-md-12 col-lg-12 col-xl-12">
                                <div id="accordion" class="w-100 br-2 overflow-hidden">
                                    @{
                                        int nextRow = 0;
                                    }
                                    @for (int index = 0; index < Model.Count(); index++)
                                    {
                                        var referralGroup = Model[index];
                                        if (referralGroup.Referrals.Count() > 0)
                                        {
                                            <div class="">
                                                <div class="accor bg-primary" id="headingOne@(index)">
                                                    <h4 class="m-0">
                                                        <a href="#collapseOne@(index)" class="" data-toggle="collapse" aria-expanded="true" aria-controls="collapseOne">
                                                            <i class="si si-cursor-move mr-2"></i>@referralGroup.Name
                                                        </a>
                                                    </h4>
                                                </div>

                                                <div id="collapseOne@(index)" class="collapse @(nextRow == 0 ? "show":"") bg-white" aria-labelledby="headingOne" data-parent="#accordion">
                                                    <div class="border">
                                                        @if (!string.IsNullOrWhiteSpace(referralGroup.Description))
                                                        {
                                                            <div class="row">
                                                                <div class="col col-md-12">
                                                                    <div class="card">
                                                                        <div class="card-body">
                                                                            <div class="" id="container@(index)">
                                                                                <div class="filter-product-checkboxs">
                                                                                    @Html.Raw(referralGroup.Description)
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }
                                                        <div class="row">
                                                            @foreach (var referral in referralGroup.Referrals)
                                                            {
                                                                <div class="col-xl-4">
                                                                    <div class="card">
                                                                        <div class="card-body text-center box-referral">
                                                                            <span class="avatar avatar-xxl brround cover-image default-shadow" data-image-src="@referral.BlogImage" style="background-color:silver"></span>
                                                                            <h4 class="h4 mb-1 mt-3">@referral.BlogName</h4>
                                                                            <p class="text-muted leading-tight pl-1 pr-1 fs-13">@referral.BlogDescription</p>
                                                                            <div class="justify-content-center text-center mt-3 d-flex">
                                                                                <a href="#" class="btn btn-secondary-light pl-3 pr-3 mr-3 btn-link"
                                                                                   data-blog-id="@referral.BlogId"><i class="fa fa-registered"></i> Đăng Ký</a>
                                                                                <a href="#" class="btn btn-info-light pl-3 pr-3 mr-3 btn-detail"
                                                                                   data-blog-id="@referral.BlogId"><i class="fa fa-eye"></i> Chi Tiết</a>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            nextRow++;
                                        }
                                    }
                                </div>
                            </div>
                        </div>
                        <!-- row -->
                    </div>
                </div>
            </div>
        </div>
        <!-- row closed -->
    </div>
</div>
@Html.Partial("_DetailModal")
@Html.Partial("_LinkModal")
